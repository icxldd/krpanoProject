<krpano>

	<style name="ccc"  css="calc('margin-top:100px;')"/>
 <!-- 代码复制 开始位置 -->
 
	<!-- 地图部分 url对应的是地图本身的路径，按照自己的文件修改url中数值 -->
	<layer  name="map" url="../1.png" keep="true" handcursor="false" capture="false"
	       align="rightbottom"
	       scale="0.25" scalechildren="true"
            y="70" x="0"
            visible="true"
	       >
		<!-- 激活点图像 (覆盖在普通的地图点上) -->
		<layer name="activespot1" url="../assest/images/select.png"  visible="fasle"
		       align="righttop" edge="center" zorder="2" scale.mobile="2"
		       />
	 
		<!-- 雷达 (也覆盖在地图点上, 但在激活点图像后面) -->
		<layer name="radar1" 
		       url.flash="%SWFPATH%/plugins/radar.swf"
		       url.html5="%SWFPATH%/plugins/radar.js"
		       align="righttop" edge="center" zorder="1"
		       scale.mobile="1.5"
              
               visible="false"
		       fillalpha="0.5" fillcolor="0x7F5F3F"
		       linewidth="1.0" linecolor="0xE0E0A0" linealpha="0.5"
		       />

       	<!-- 地图点图像部分 url可以设置 用style来统一处理 所有layer都载入了一个名为mapspot的style，注意这里spot是由0开始，而不是由1开始的，因此在一般情况下，地图点与场景一一对应，而场景的index是从0开始的，所以我们可以利用这一点提高代码的可读性 -->
	
		<layer name="spot0" style="mapspot" x="474" y="314" zorder="1" onclick="mapspot_loadscene1();" />
		<layer name="spot1" style="mapspot" x="372" y="250" zorder="1" onclick="mapspot_loadscene1();" />
		<layer name="spot2" style="mapspot" x="732" y="315" zorder="1" onclick="mapspot_loadscene1();" />  



        <layer name="spot4" style="mapspot2" x="1032" y="100" zorder="1" onclick="mapspot_add_page();" />  
        <layer name="spot5" style="mapspot3" x="1032" y="315" zorder="1" onclick="mapspot_sub_page();" />  
	</layer>


<layer  name="map2" url="../2.png" keep="true" handcursor="false" capture="false"
	       align="rightbottom"
	       scale="0.25" scalechildren="true"
            y="70" x="0"
            visible="false"
	       >
		<!-- 激活点图像 (覆盖在普通的地图点上) -->
		<layer name="activespot2" url="../assest/images/select.png"  visible="false"
		       align="righttop" edge="center" zorder="2" scale.mobile="2"
		       />
	 
		<!-- 雷达 (也覆盖在地图点上, 但在激活点图像后面) -->
		<layer name="radar2" 
		       url.flash="%SWFPATH%/plugins/radar.swf"
		       url.html5="%SWFPATH%/plugins/radar.js"
		       align="righttop" edge="center" zorder="1"
		       scale.mobile="1.5"
               visible="false"
		       fillalpha="0.5" fillcolor="0x7F5F3F"
		       linewidth="1.0" linecolor="0xE0E0A0" linealpha="0.5"
		       />

       	<!-- 地图点图像部分 url可以设置 用style来统一处理 所有layer都载入了一个名为mapspot的style，注意这里spot是由0开始，而不是由1开始的，因此在一般情况下，地图点与场景一一对应，而场景的index是从0开始的，所以我们可以利用这一点提高代码的可读性 -->
	
		<layer name="spot10" style="mapspot" x="474" y="314" zorder="1" onclick="mapspot_loadscene2();" />
		<layer name="spot11" style="mapspot" x="372" y="250" zorder="1" onclick="mapspot_loadscene2();" />
		<layer name="spot22" style="mapspot" x="732" y="315" zorder="1" onclick="mapspot_loadscene2();" />  
        


         <layer name="spot44" style="mapspot2" x="1032" y="100" zorder="1" onclick="mapspot_add_page();" />  
        <layer name="spot55" style="mapspot3" x="1032" y="315" zorder="1" onclick="mapspot_sub_page();" />  
	</layer>



    <layer  name="map3" url="../3.png" keep="true" handcursor="false" capture="false"
	       align="rightbottom"
	       scale="0.25" scalechildren="true"
             y="70" x="0"
            visible="false"
            
	       >
		<!-- 激活点图像 (覆盖在普通的地图点上) -->
		<layer name="activespot3" url="../assest/images/select.png" visible="false"
		       align="righttop" edge="center" zorder="2" scale.mobile="2"
		       />
	 
		<!-- 雷达 (也覆盖在地图点上, 但在激活点图像后面) -->
		<layer name="radar3" 
		       url.flash="%SWFPATH%/plugins/radar.swf"
		       url.html5="%SWFPATH%/plugins/radar.js"
		       align="righttop" edge="center" zorder="1"
		       scale.mobile="1.5"
               visible="false"
		       fillalpha="0.5" fillcolor="0x7F5F3F"
		       linewidth="1.0" linecolor="0xE0E0A0" linealpha="0.5"
		       />

       	<!-- 地图点图像部分 url可以设置 用style来统一处理 所有layer都载入了一个名为mapspot的style，注意这里spot是由0开始，而不是由1开始的，因此在一般情况下，地图点与场景一一对应，而场景的index是从0开始的，所以我们可以利用这一点提高代码的可读性 -->
	
		
		<layer name="spot25" style="mapspot" x="372" y="250" zorder="1" onclick="mapspot_loadscene3();" />
		<layer name="spot26" style="mapspot" x="732" y="315" zorder="1" onclick="mapspot_loadscene3();" />  
        <layer name="spot27" style="mapspot" x="474" y="314" zorder="1" onclick="mapspot_loadscene3();" />

        <layer name="spot444" style="mapspot2" x="1032" y="100" zorder="1" onclick="mapspot_add_page();" />  
        <layer name="spot555" style="mapspot3" x="1032" y="315" zorder="1" onclick="mapspot_sub_page();" />  
	</layer>



	<style name="mapspot"  url="../assest/images/noselect.png"  align="righttop" edge="center" scale.mobile="2" />

    <style name="mapspot2"  url="../assest/images/noup.png"  align="righttop" edge="center" scale.mobile="2" />

<style name="mapspot3"  url="../assest/images/nodown.png"  align="righttop" edge="center" scale.mobile="2" />
    
 
    
    
    <action name="mapspot_add_page">
        jscall('add()');
        
        jsget(ret, 'selfI');
        <!-- jscall(calc('console.log("debug: ' + ret+ '")')); -->
        if(ret == 1,set(layer[map].visible, false);set(layer[map3].visible, false);set(layer[map2].visible, true);
        );

        if(ret == 2,set(layer[map].visible, false));
       if(ret == 2,set(layer[map2].visible, false));
       if(ret == 2,set(layer[map3].visible, true));
       
        

<!--      
        jsget(ret, 'selfI');
        jscall(calc('console.log("debug: ' + ret+ '")')); -->
    
    </action>


     <action name="mapspot_sub_page">
        
        jscall(calc('sub()'));

        jsget(ret, 'selfI');
        jscall(calc('console.log("debug: ' + ret+ '")'));
        if(ret == 0,set(layer[map2].visible, false);set(layer[map3].visible, false);set(layer[map].visible, true);
        );

        if(ret == 1,set(layer[map].visible, false);set(layer[map3].visible, false);set(layer[map2].visible, true);
        );
    
    
    </action>
	<!-- 当点击地图点时执行的动作 -->
	<action name="mapspot_loadscene1">
		subtxt(spotid,get(name),4,2);
 
		if(layer[map].scale GT 0.25,
			<!-- 当地图放大时需要执行更多特殊的动作，缩小地图等 -->
			set(layer[map].enabled, false);
			tween(layer[map].alpha, 0.0, 0.25, default,
			
			if(spotid != scene[get(xml.scene)].index,  
			  loadscene(get(scene[get(spotid)].name),null,MERGE,BLEND(1)); 
			  );
				
				set(layer[map].onclick, openmap(); );
				layer[map].changeorigin(rightbottom,rightbottom);
 
				set(layer[map].x, 0);
				set(layer[map].y, 0);
				set(layer[map].scale, 0.25);
 
				set(events[sceneload].onloadcomplete,
					delayedcall(1,
						tween(layer[map].alpha, 1.0, 0.5, default, set(layer[map].enabled, true); );
					  );
				  );
			  );
		  ,
			<!-- 小地图时只需要载入场景 -->
			if(spotid != scene[get(xml.scene)].index,  
                jscall(calc('setClickCoockie("'+spotid+'")'));
                loadscene(get(scene[get(spotid)].name),null,MERGE,BLEND(1));  

                
			  );
		  );
	</action>
 <action name="updateradar">  
      <!-- jscall(calc('console.log("debug:123")')); -->
                jsget(cc, 'selfClick');
                <!-- def(s, string, calc(cc)); -->
	    <!-- jscall(calc('console.log("debug: ' + calc(cc)+ '")')); -->
         <!-- jscall(calc('console.log("debug: ' + get.x+ '")')); -->
                <!-- txtadd(spotidnow,'spot',cc));   -->
                 <!-- jscall(calc('console.log("debug:123")')); -->

                copy(layer[radar1].x, layer[calc(cc)].x);  
                copy(layer[radar1].y, layer[calc(cc)].y);  
                copy(layer[activespot1].x, layer[calc(cc)].x);  
	            copy(layer[activespot1].y, layer[calc(cc)].y);  
                set(layer[activespot1].visible, true);  
                set(layer[radar1].visible, true);  




                copy(layer[radar2].x, layer[calc(cc)].x);  
                copy(layer[radar2].y, layer[calc(cc)].y);  
                copy(layer[activespot2].x, layer[calc(cc)].x);  
	            copy(layer[activespot2].y, layer[calc(cc)].y);  
                set(layer[activespot2].visible, true);  
                set(layer[radar2].visible, true);  




                copy(layer[radar3].x, layer[calc(cc)].x);  
                copy(layer[radar3].y, layer[calc(cc)].y);  
                copy(layer[activespot3].x, layer[calc(cc)].x);  
	            copy(layer[activespot3].y, layer[calc(cc)].y);  
                set(layer[activespot3].visible, true);  
                set(layer[radar3].visible, true);  
	</action>
    <action name="mapspot_loadscene2">
		subtxt(spotid,get(name),4,2);
   jscall(calc('console.log("debug: ' + spotid+ '")'));
		if(layer[map2].scale GT 0.25,
			<!-- 当地图放大时需要执行更多特殊的动作，缩小地图等 -->
			set(layer[map2].enabled, false);
			tween(layer[map2].alpha, 0.0, 0.25, default,
			
			if(spotid != scene[get(xml.scene)].index,  
			  loadscene(get(scene[get(spotid)].name),null,MERGE,BLEND(1)); 
			  );
				
				set(layer[map2].onclick, openmap(); );
				layer[map2].changeorigin(rightbottom,rightbottom);
 
				set(layer[map2].x, 0);
				set(layer[map2].y, 0);
				set(layer[map2].scale, 0.25);
 
				set(events[sceneload].onloadcomplete,
					delayedcall(1,
						tween(layer[map2].alpha, 1.0, 0.5, default, set(layer[map2].enabled, true); );
					  );
				  );
			  );
		  ,
			<!-- 小地图时只需要载入场景 -->
			if(spotid != scene[get(xml.scene)].index,  

     jscall(calc('setClickCoockie("'+spotid+'")'));
			  loadscene(get(scene[get(spotid)].name),null,MERGE,BLEND(1)); 



			  );
				
		  );
	</action>


    <action name="mapspot_loadscene3">
		subtxt(spotid,get(name),4,2);
 
		if(layer[map3].scale GT 0.25,
			<!-- 当地图放大时需要执行更多特殊的动作，缩小地图等 -->
			set(layer[map3].enabled, false);
			tween(layer[map3].alpha, 0.0, 0.25, default,
			
			if(spotid != scene[get(xml.scene)].index,  
			  loadscene(get(scene[get(spotid)].name),null,MERGE,BLEND(1)); 
			  );
				
				set(layer[map3].onclick, openmap(); );
				layer[map3].changeorigin(rightbottom,rightbottom);
 
				set(layer[map3].x, 0);
				set(layer[map3].y, 0);
				set(layer[map3].scale, 0.25);
 
				set(events[sceneload].onloadcomplete,
					delayedcall(1,
						tween(layer[map3].alpha, 1.0, 0.5, default, set(layer[map3].enabled, true); );
					  );
				  );
			  );
		  ,
			<!-- 小地图时只需要载入场景 -->
			if(spotid != scene[get(xml.scene)].index,  
             jscall(calc('setClickCoockie("'+spotid+'")'));
			  loadscene(get(scene[get(spotid)].name),null,MERGE,BLEND(1)); 
            
			  );
				
		  );
	</action>

 
	<!-- 代码复制结束部分 -->


</krpano>
